clc
clear all
close all

%Time properties
t = 0:0.01:2;
T = 2;
tn = t/T;

%Physiology properties
qs = deg2rad(90);
qe = deg2rad(130);
qw = deg2rad(90);
Q(:,1)= [qs;...
         qe;...
         qw];
ls = 0.3;
le = 0.3;
lw = 0.15;

%Position profile as given in the question
x_tn = 0.1289*tn.^3.*(6*tn.^2-15*tn+10)-0.1334;
y_tn = 0.7355*tn.^3.*(6*tn.^2-15*tn+10)-0.0077;

%Velocity profile found by derivative of position w.r.t t
Vx = 0.1289*(30*tn.^4-60*tn.^3+30*tn.^2)/T;
Vy = 0.7355*(30*tn.^4-60*tn.^3+30*tn.^2)/T;

for i = 1:length(t)
    %Evaluate inverse jacobian
    JinvLoop = updateJinv(ls, le, lw, Q(1,i), Q(2,i), Q(3,i));
    
    %Calculate maximum value in jacobian - mainly for debugging
    %singularities
    MaxJ(i) = max(max(JinvLoop));
    
    %Calculate angular speed
    omega(:,i) = JinvLoop*[Vx(i); Vy(i)];
    
    %Calculate new angles
    Q(:,i+1) = Q(:,i) + omega(:,i)*0.01;
end

 
%% Plotting
figure(1)
plot(t, x_tn)
hold on
plot(t, y_tn)
xlabel('Time [s]')
ylabel('Position [m]')
legend('x','y')
grid on

% figure(2)
% plot(x_tn,y_tn)
% xlabel('X-Position')
% ylabel('Y-Position')
% grid on

figure(3)
plot(t, Vx)
hold on
plot(t, Vy)
xlabel('Time [s]')
ylabel('Velocity [m/s]')
legend('x','y')
grid on

% figure(4)
% plot(Vx,Vy)
% xlabel('X-Velocity')
% ylabel('Y-Velocity')
% grid on

figure(5)
plot(t, rad2deg(omega'))
title('Joint Angle Speed')
xlabel('Time [s]')
ylabel('Angular Velocity [^o/s]')
legend('qs','qe','qw')
grid on

figure(6)
plot(t, rad2deg(Q(:,1:length(t))'))
title('Joint Angles')
xlabel('Time [s]')
ylabel('Angles [^o]')
legend('qs','qe','qw')
grid on

figure(7)
plot(t, MaxJ)
title('Jacobian')
xlabel('Time')
ylabel('Max(Jacobian)')

function [JinvUpdated] = updateJinv(Ls, Le, Lw, S, E, W)


JinvUpdated = [ ((sin(conj(S))*conj(Ls) + sin(conj(E) + conj(S))*conj(Le) + conj(Lw)*sin(conj(E) + conj(S) + conj(W)))*(Lw*cos(conj(S))*conj(Ls)*cos(E + S + W) + Ls*cos(conj(S))*conj(Ls)*cos(S) + 2*Lw*cos(conj(E) + conj(S))*conj(Le)*cos(E + S + W) + Ls*cos(conj(E) + conj(S))*conj(Le)*cos(S) + 2*Le*cos(E + S)*conj(Lw)*cos(conj(E) + conj(S) + conj(W)) + Le*cos(conj(S))*cos(E + S)*conj(Ls) + 2*Le*cos(conj(E) + conj(S))*cos(E + S)*conj(Le) + 3*Lw*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W))))/(Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) - Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) + Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Le*Lw*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - Le*Lw*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*cos(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*cos(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) - Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) - Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) + Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) + 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W))) - ((cos(conj(S))*conj(Ls) + cos(conj(E) + conj(S))*conj(Le) + conj(Lw)*cos(conj(E) + conj(S) + conj(W)))*(Lw*sin(conj(S))*conj(Ls)*cos(E + S + W) + Ls*sin(conj(S))*conj(Ls)*cos(S) + 2*Lw*sin(conj(E) + conj(S))*conj(Le)*cos(E + S + W) + Ls*sin(conj(E) + conj(S))*conj(Le)*cos(S) + 2*Le*cos(E + S)*conj(Lw)*sin(conj(E) + conj(S) + conj(W)) + Le*sin(conj(S))*cos(E + S)*conj(Ls) + 2*Le*sin(conj(E) + conj(S))*cos(E + S)*conj(Le) + 3*Lw*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Ls*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W))))/(Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) - Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) + Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Le*Lw*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - Le*Lw*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*cos(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*cos(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) - Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) - Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) + Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) + 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W))), ((sin(conj(S))*conj(Ls) + sin(conj(E) + conj(S))*conj(Le) + conj(Lw)*sin(conj(E) + conj(S) + conj(W)))*(Lw*cos(conj(S))*conj(Ls)*sin(E + S + W) + Ls*cos(conj(S))*conj(Ls)*sin(S) + 2*Lw*cos(conj(E) + conj(S))*conj(Le)*sin(E + S + W) + Ls*cos(conj(E) + conj(S))*conj(Le)*sin(S) + 2*Le*sin(E + S)*conj(Lw)*cos(conj(E) + conj(S) + conj(W)) + Le*cos(conj(S))*sin(E + S)*conj(Ls) + 2*Le*cos(conj(E) + conj(S))*sin(E + S)*conj(Le) + 3*Lw*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W))))/(Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) - Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) + Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Le*Lw*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - Le*Lw*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*cos(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*cos(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) - Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) - Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) + Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) + 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W))) - ((cos(conj(S))*conj(Ls) + cos(conj(E) + conj(S))*conj(Le) + conj(Lw)*cos(conj(E) + conj(S) + conj(W)))*(3*Lw*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Ls*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) + Lw*sin(conj(S))*conj(Ls)*sin(E + S + W) + Ls*sin(conj(S))*conj(Ls)*sin(S) + 2*Lw*sin(conj(E) + conj(S))*conj(Le)*sin(E + S + W) + Ls*sin(conj(E) + conj(S))*conj(Le)*sin(S) + 2*Le*sin(E + S)*conj(Lw)*sin(conj(E) + conj(S) + conj(W)) + Le*sin(conj(S))*sin(E + S)*conj(Ls) + 2*Le*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)))/(Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) - Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) + Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Le*Lw*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - Le*Lw*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*cos(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*cos(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) - Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) - Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) + Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) + 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)));...
                                              ((sin(conj(E) + conj(S))*conj(Le) + conj(Lw)*sin(conj(E) + conj(S) + conj(W)))*(Lw*cos(conj(S))*conj(Ls)*cos(E + S + W) + Ls*cos(conj(S))*conj(Ls)*cos(S) + 2*Lw*cos(conj(E) + conj(S))*conj(Le)*cos(E + S + W) + Ls*cos(conj(E) + conj(S))*conj(Le)*cos(S) + 2*Le*cos(E + S)*conj(Lw)*cos(conj(E) + conj(S) + conj(W)) + Le*cos(conj(S))*cos(E + S)*conj(Ls) + 2*Le*cos(conj(E) + conj(S))*cos(E + S)*conj(Le) + 3*Lw*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W))))/(Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) - Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) + Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Le*Lw*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - Le*Lw*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*cos(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*cos(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) - Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) - Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) + Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) + 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W))) - ((cos(conj(E) + conj(S))*conj(Le) + conj(Lw)*cos(conj(E) + conj(S) + conj(W)))*(Lw*sin(conj(S))*conj(Ls)*cos(E + S + W) + Ls*sin(conj(S))*conj(Ls)*cos(S) + 2*Lw*sin(conj(E) + conj(S))*conj(Le)*cos(E + S + W) + Ls*sin(conj(E) + conj(S))*conj(Le)*cos(S) + 2*Le*cos(E + S)*conj(Lw)*sin(conj(E) + conj(S) + conj(W)) + Le*sin(conj(S))*cos(E + S)*conj(Ls) + 2*Le*sin(conj(E) + conj(S))*cos(E + S)*conj(Le) + 3*Lw*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Ls*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W))))/(Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) - Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) + Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Le*Lw*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - Le*Lw*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*cos(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*cos(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) - Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) - Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) + Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) + 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W))),                                                 ((sin(conj(E) + conj(S))*conj(Le) + conj(Lw)*sin(conj(E) + conj(S) + conj(W)))*(Lw*cos(conj(S))*conj(Ls)*sin(E + S + W) + Ls*cos(conj(S))*conj(Ls)*sin(S) + 2*Lw*cos(conj(E) + conj(S))*conj(Le)*sin(E + S + W) + Ls*cos(conj(E) + conj(S))*conj(Le)*sin(S) + 2*Le*sin(E + S)*conj(Lw)*cos(conj(E) + conj(S) + conj(W)) + Le*cos(conj(S))*sin(E + S)*conj(Ls) + 2*Le*cos(conj(E) + conj(S))*sin(E + S)*conj(Le) + 3*Lw*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W))))/(Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) - Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) + Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Le*Lw*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - Le*Lw*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*cos(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*cos(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) - Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) - Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) + Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) + 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W))) - ((cos(conj(E) + conj(S))*conj(Le) + conj(Lw)*cos(conj(E) + conj(S) + conj(W)))*(3*Lw*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Ls*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) + Lw*sin(conj(S))*conj(Ls)*sin(E + S + W) + Ls*sin(conj(S))*conj(Ls)*sin(S) + 2*Lw*sin(conj(E) + conj(S))*conj(Le)*sin(E + S + W) + Ls*sin(conj(E) + conj(S))*conj(Le)*sin(S) + 2*Le*sin(E + S)*conj(Lw)*sin(conj(E) + conj(S) + conj(W)) + Le*sin(conj(S))*sin(E + S)*conj(Ls) + 2*Le*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)))/(Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) - Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) + Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Le*Lw*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - Le*Lw*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*cos(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*cos(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) - Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) - Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) + Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) + 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)));...
                                                                                                                     (conj(Lw)*sin(conj(E) + conj(S) + conj(W))*(Lw*cos(conj(S))*conj(Ls)*cos(E + S + W) + Ls*cos(conj(S))*conj(Ls)*cos(S) + 2*Lw*cos(conj(E) + conj(S))*conj(Le)*cos(E + S + W) + Ls*cos(conj(E) + conj(S))*conj(Le)*cos(S) + 2*Le*cos(E + S)*conj(Lw)*cos(conj(E) + conj(S) + conj(W)) + Le*cos(conj(S))*cos(E + S)*conj(Ls) + 2*Le*cos(conj(E) + conj(S))*cos(E + S)*conj(Le) + 3*Lw*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W))))/(Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) - Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) + Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Le*Lw*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - Le*Lw*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*cos(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*cos(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) - Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) - Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) + Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) + 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W))) - (conj(Lw)*cos(conj(E) + conj(S) + conj(W))*(Lw*sin(conj(S))*conj(Ls)*cos(E + S + W) + Ls*sin(conj(S))*conj(Ls)*cos(S) + 2*Lw*sin(conj(E) + conj(S))*conj(Le)*cos(E + S + W) + Ls*sin(conj(E) + conj(S))*conj(Le)*cos(S) + 2*Le*cos(E + S)*conj(Lw)*sin(conj(E) + conj(S) + conj(W)) + Le*sin(conj(S))*cos(E + S)*conj(Ls) + 2*Le*sin(conj(E) + conj(S))*cos(E + S)*conj(Le) + 3*Lw*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Ls*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W))))/(Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) - Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) + Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Le*Lw*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - Le*Lw*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*cos(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*cos(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) - Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) - Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) + Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) + 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W))),                                                                                                                         (conj(Lw)*sin(conj(E) + conj(S) + conj(W))*(Lw*cos(conj(S))*conj(Ls)*sin(E + S + W) + Ls*cos(conj(S))*conj(Ls)*sin(S) + 2*Lw*cos(conj(E) + conj(S))*conj(Le)*sin(E + S + W) + Ls*cos(conj(E) + conj(S))*conj(Le)*sin(S) + 2*Le*sin(E + S)*conj(Lw)*cos(conj(E) + conj(S) + conj(W)) + Le*cos(conj(S))*sin(E + S)*conj(Ls) + 2*Le*cos(conj(E) + conj(S))*sin(E + S)*conj(Le) + 3*Lw*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W))))/(Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) - Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) + Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Le*Lw*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - Le*Lw*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*cos(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*cos(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) - Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) - Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) + Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) + 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W))) - (conj(Lw)*cos(conj(E) + conj(S) + conj(W))*(3*Lw*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Ls*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) + Lw*sin(conj(S))*conj(Ls)*sin(E + S + W) + Ls*sin(conj(S))*conj(Ls)*sin(S) + 2*Lw*sin(conj(E) + conj(S))*conj(Le)*sin(E + S + W) + Ls*sin(conj(E) + conj(S))*conj(Le)*sin(S) + 2*Le*sin(E + S)*conj(Lw)*sin(conj(E) + conj(S) + conj(W)) + Le*sin(conj(S))*sin(E + S)*conj(Ls) + 2*Le*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)))/(Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) - Ls*Lw*cos(conj(S))*sin(conj(E) + conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(E + S + W)*sin(S) + Ls*Lw*cos(conj(E) + conj(S))*sin(conj(S))*conj(Le)*conj(Ls)*cos(S)*sin(E + S + W) - Le*Lw*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + Le*Lw*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - Le*Lw*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*cos(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*sin(conj(E) + conj(S) + conj(W)) - Le*Ls*sin(conj(S))*cos(E + S)*conj(Ls)*conj(Lw)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*sin(conj(S))*sin(E + S)*conj(Ls)*conj(Lw)*cos(S)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*cos(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*cos(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*sin(conj(E) + conj(S) + conj(W)) + 2*Le*Lw*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Lw)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) - 2*Le*Lw*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Lw)*cos(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) - Le*Ls*cos(conj(S))*sin(conj(E) + conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) - Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*cos(E + S)*conj(Le)*conj(Ls)*sin(S) + Le*Ls*cos(conj(E) + conj(S))*sin(conj(S))*sin(E + S)*conj(Le)*conj(Ls)*cos(S) + 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*cos(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + 2*Ls*Lw*sin(conj(S))*conj(Ls)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*cos(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*sin(conj(E) + conj(S) + conj(W)) - Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(E + S + W)*sin(S)*cos(conj(E) + conj(S) + conj(W)) + Ls*Lw*sin(conj(E) + conj(S))*conj(Le)*conj(Lw)*cos(S)*sin(E + S + W)*cos(conj(E) + conj(S) + conj(W)))];
 
                                                                                                                  
end